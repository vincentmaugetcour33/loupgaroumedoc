{% extends "::base.html.twig" %}

        
{% block body %}

{% if form is defined %}
    
    
    
{#{% form_theme form _self %}
    {% use 'form_div_layout.html.twig' with form_label as base_form_label %}

    {% block form_label %}
        {{ block('base_form_label') }}

        {% if required %}
            <span class="required" title="Ce champ est obligatoire">*</span>
        {% endif %}
    {% endblock %}
#}

    <div class="panel panel-info"> 
      <div class="panel-heading">
         {% if editer is defined %} MODIFICATION {% else %} ENREGISTREMENT {% endif %}PROFIL
       </div>
            
      <div class="panel-body">
          <p style="color:red;">
              Les champs marqués d'un astérisque sont obligatoires.
              {% if editer is defined %}
                  Si vous ne saisissez pas un nouveau mot de passe, votre mot de passe actuel est conservé. 
              {% endif %}
          </p>
          
          <p class="text-info">
              {% if editer is not defined %}
                  <b>Attention</b>, pour le moment l'ajout d'une photo personalisée ne peut être modifiée
                  ensuite. Sinon, il vous faudra supprimer votre compte et le recréer.
                  Si vous ne sélectionnez aucune photo, une photo par défaut sera attribuée à votre profil.
              {% endif %}
          </p>
        
   <form class="" method="post" action="{% if editer is defined %}{{ path('vm_user_edit') }}{% else %}{{ path('vm_user_ajout') }}{% endif %}" {{ form_enctype(form) }} >
       <table>
       {% if editer is defined %}
                {% if app.user.photoperso == true %}
                ( actuelle : <a class="photo" id="{{app.user.id}}" href="#" style="cursor: pointer;" rel="popover" title="{{app.user.username}}" >{{app.user.photo}}</a> )
                {% endif %}  

      {% endif %} 
        
      
      <tr>
      {# username #}
      {#{{ form_row(form.username) }}#}
      <td>{{ form_label(form.username) }}</td>
      <td><span class="text-warning">{{ form_errors(form.username) }}</span></td>
      <td>{{ form_widget(form.username) }}</td> 
       </tr>
      
      <tr> 
        {# password #}
      {#{{ form_row(form.password) }}#}
      <td>{{ form_label(form.password) }}</td>
      <td><span class="text-warning">{{ form_errors(form.password) }}</span></td>
      <td>{{ form_widget(form.password) }}</td>      
     </tr>
     
      <tr>
      {# email #}
       <td>{{ form_label(form.email) }}</td>
      <td><span class="text-warning">{{ form_errors(form.email) }}</span></td>
      <td>{{ form_widget(form.email) }}</td>   
     </tr>

      
        <tr>
       {# realname #}
                <td>{{ form_label(form.realname) }}</td>
       <td><span class="text-warning">{{ form_errors(form.realname) }}</span></td>
      <td>{{ form_widget(form.realname) }}</td>
      </tr>
 
       
       {# sexe #}
      {% if editer is defined %}
      
                {% if app.user.photoperso == false %}
                    <tr>
                      <td>{{ form_label(form.sexe) }}</td>
                      <td><span class="text-warning">{{ form_errors(form.sexe) }}</span></td>
                     <td>{{ form_widget(form.sexe) }}</td>
                    </tr>   
                {% endif %}
       {% else %}
              <tr>
                      <td>{{ form_label(form.sexe) }}</td>
                      <td><span class="text-warning">{{ form_errors(form.sexe) }}</span></td>
                     <td>{{ form_widget(form.sexe) }}</td>
                    </tr>        
       {% endif %}
        
                    {% if editer is not defined %}
         <tr>
      {# photo personnelle #}
                <td>{{ form_label(form.file) }}</td>
         <td><span class="text-warning">{{ form_errors(form.file) }}</span></td>
         <td>{{ form_widget(form.file) }} </td>  
      </tr>
                {% endif %}
      
        <tr>
      {# ville #}
                <td>{{ form_label(form.ville) }}</td>
         <td><span class="text-warning">{{ form_errors(form.ville) }}</span></td>
         <td>{{ form_widget(form.ville) }} </td>  
      </tr>
      
      <tr>
      {# age #}
      <td>{{ form_label(form.age) }}</td>
      <td><span class="text-warning">{{ form_errors(form.age) }}</span></td>
      <td>{{ form_widget(form.age) }}</td>   
      </tr>  
      
      </table>
      {{ form_widget(form._token) }}
       
      <input type="submit" value="{% if editer is defined %}Modifier{% else %}Ajouter{% endif %}" class="btn btn-default" />
      <input type="button" value="annuler"  onclick="javascript:history.back()" class="btn btn-primary" />
  </form>
              </div></div>
              
{% endif %}

{% endblock body %}

{% block javascripts %}
    {{ parent() }} 
        <script language="javascript" type="text/javascript"> 
     (function($) { 
        $("a.photo").popover({trigger: 'hover',html:true, content: function() { var photo=$(this).attr('id')+'-'+$(this).html();
               return "<img class='img-rounded' width=50 src='/bundles/vmuser/photo/"+photo+"' />"; },
                delay: { show: 500, hide: 10} });

    }(jQuery));
    </script>
{% endblock javascripts %}